# Linux 基础

## 应用场景

### 为什么是服务器部署的首选

- **性能**：不同于 Windows/macOS 内置了很多系统软件和 GUI 图形界面，Linux Server 像是经过 `code splitting` 和 `tree shaking` 后的生产代码，仅保留核心内容，没有其他多余的性能开销，服务器可以连续运行多年不重启。
- **权限与安全**：Linux 有极其严格的权限管理。
- **开源免费**：开源且生态丰富，有多个不同的发行版。

> **什么是 Shell**
>
> Shell 相当于浏览器的控制台或 DOM 接口，提供了交互的场所，以及作为翻译官将开发者的命令传给内核。

### 主要应用领域

**服务器端（最核心）：** 它是互联网的基础设施，绝大多数的 Web 服务器（如 Nginx）、数据库（MySQL）、以及我们运行的 Node.js/Java 服务都部署在 Linux 上，因为它稳定、安全且资源占用少。

**嵌入式与移动端：** Android 系统的底层就是 Linux 内核；智能家居、路由器等 IoT 设备也大多运行精简版的 Linux。

**开发与运维（DevOps）：** 现在的云原生技术（Docker, K8s）完全是基于 Linux 容器技术构建的。作为开发者，熟悉 Linux 能让我更好地理解 CI/CD 流程和线上环境排查。

## 文件系统

### 核心哲学：一切皆文件

在 Linux 中，鼠标、硬盘、进程等等都是文件，意味着可以通过读写文本命令去操控硬件，修改系统配置。

### 目录结构

文件系统的根被称作 `/`，也就是根目录。

此外还有个比较重要的是 `~` 作为 Home：

- 如果以管理员登录，则为 `/root`
- 如果以普通用户登录，Home 路径则通常为 `/home/user`

#### 绝对路径与相对路径

- **绝对路径**：以 `/` 开始

  ```bash
  cd /usr/local/bin
  ```

- **相对路径**：不以 `/` 开始
  - `.` 表示当前目录
  - `..` 表示上一级目录

#### Linux 常用目录

Linux 的目录结构遵循标准。以下是相对常用的三个目录：

- **`/etc`**：系统的配置文件存放的地方，比如 `/etc/nginx/` 一般是 Nginx 的配置文件
- **`/var`**：存放经常变动的文件，最重要的是**日志**
- **`/bin` 或 `/usr/bin`**：存放可执行命令的地方，比如 `ls`、`cp` 这些就存在这里

### 权限管理

Linux 把系统使用者分为三个角色：

- **拥有者（Owner）**
- **同组人（Group）**
- **其他（Others）**

每个角色的权限细化为三个能力：

- **r（读）**：对应数字 4
- **w（写）**：对应数字 2
- **x（执行）**：对应数字 1

由于它们在二进制中是不同的数位，从 0-7 的数字就能覆盖一个用户读写执行三个权限的所有情况。

#### 权限示例

**案例 A：644 `rw-r--r--`**

- **拥有者（6）**：4（可读）+ 2（可写）
- **同组人（4）**：4（只读）
- **其他人（4）**：4（只读）

**案例 B：777 `rwxrwxrwx`（全开权限）**

- **拥有者（7）**：4 + 2 + 1（读写执行）
- **同组人（7）**：4 + 2 + 1（读写执行）
- **其他人（7）**：4 + 2 + 1（读写执行）
- **⚠️ 后果**：任何人都能删你的库。

**案例 C：755 `rwxr-xr-x`（最常见的程序/脚本/文件夹权限）**

- **拥有者（7）**：读写执行（我拥有完全控制权）
- **同组人（5）**：4 + 1 = 读 + 执行（同事可以运行代码，但不能改）
- **其他人（5）**：读 + 执行（路人可以运行，不能改）

> **提示**：文件夹一般都有 1 的 x 执行权限，否则无法 `cd` 进入。

#### 修改权限

可以通过 `chmod` 来修改权限：

```bash
chmod 777 readme.md
chmod +x script.sh  # 给当前脚本所有人加执行权限
```

## 常用命令

> **管道符 `|`**
>
> 类似 JS 的 `.then()`，取上一个命令的结果塞给下一个命令处理。

| **命令** | **英文**                            | **功能**               | **核心用法/例子**                                                                            |
| -------- | ----------------------------------- | ---------------------- | -------------------------------------------------------------------------------------------- |
| `ls`     | list                                | 列出当前文件夹下的内容 | `ls -la` 列出当前文件夹下所有文件（包括隐藏的）                                              |
| `pwd`    | **P**rint **W**orking **D**irectory | 输出当前所在的绝对路径 | `pwd`                                                                                        |
| `mkdir`  | make directory                      | 新建文件夹             | `mkdir newFolder`                                                                            |
| `touch`  | Touch                               | 新建空文件             | `touch server.js`（创建一个空文件）                                                          |
| `cp`     | **C**o**p**y                        | 复制                   | `cp source.js target.js`<br />`cp -r src/ backup/`（复制整个文件夹要加 `-r`）                |
| `mv`     | **M**o**v**e                        | 移动或重命名           | `mv old.js new.js`（重命名）<br />`mv file.js /tmp/`（移动）                                 |
| `rm`     | **R**e**m**ove                      | 删除                   | **⚠️ 极度危险**<br />`rm file.js`（删文件）<br />`rm -rf node_modules`（强制递归删除文件夹） |
| `grep`   | Global Regular Expression Print     | 搜索功能               | `grep "Error" app.log`                                                                       |
| `cat`    | Concatenate                         | 一次性显示文件所有内容 | `cat filename`                                                                               |
| `tail`   | Tail                                | 实时监控日志           | `tail -f app.log`                                                                            |
| `chmod`  | change mode                         | 修改权限               | `chmod +x script.sh`（给当前脚本所有人加执行权限）<br />`chmod 777 main.js`（全开权限）      |
| `ps`     | process status                      | 查看进程状态           | `ps aux`                                                                                     |
| `kill`   | kill                                | 杀死进程               | `kill {pid}`（结束进程）                                                                     |
| `lsof`   | list open files                     | 查出当前端口有哪些进程 | `lsof -i :3000`                                                                              |
