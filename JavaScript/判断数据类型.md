# åˆ¤æ–­æ•°æ®ç±»å‹

## typeof

èƒ½åŒºåˆ†åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä½†å¯¹äºå¯¹è±¡ã€æ•°ç»„ã€Map ç­‰å¤æ‚ç±»å‹éƒ½ä¼šè¿”å› `"object"`ï¼Œéœ€è¦æ³¨æ„ `null` ä¹Ÿä¼šè¢«åˆ¤æ–­ä¸º `object`

```javascript
console.log(typeof 123); // "number"
console.log(typeof "hello"); // "string"
console.log(typeof true); // "boolean"
console.log(typeof undefined); // "undefined"
console.log(typeof null); // "object"
console.log(typeof {}); // "object"
console.log(typeof []); // "object"
console.log(typeof function () {}); // "function"
console.log(typeof null); // "object"
console.log(typeof NaN); // "number"
console.log(typeof document.all); // "undefined"
```

## constructor

ç”¨äºåˆ¤æ–­ä¸€ä¸ªä¸€èˆ¬çš„ç»§æ‰¿è‡ª Objectï¼Œå¸¦æœ‰`constructor`æ–¹æ³•çš„å¯¹è±¡ï¼Œ`constructor` æŒ‡å‘åˆ›å»ºè¯¥å®ä¾‹å¯¹è±¡çš„æ„é€ å‡½æ•°
å¯ä»¥ç”¨äºåˆ¤æ–­æ•°ç»„ï¼Œå¯¹è±¡

```javascript
const arr = [1, 2, 3];
console.log(arr.constructor === Array); // true

const obj = { name: "äº‘ç‰§", age: 18 };
console.log(obj.constructor === Object); // true

String.prototype.constructor = function fn() {
  return {};
};

// constructor å¯ä»¥è¢«æ”¹å†™
console.log("äº‘ç‰§".constructor); // [Function: fn]
```

## instanceof

- è¯­æ³•ï¼šobj instanceof Type
- åŠŸèƒ½ï¼šåˆ¤æ–­ obj æ˜¯ä¸æ˜¯ Type ç±»çš„å®ä¾‹ï¼Œåªå¯ç”¨æ¥åˆ¤æ–­å¼•ç”¨æ•°æ®
- å®ç°æ€è·¯ï¼š Type çš„åŸå‹å¯¹è±¡æ˜¯å¦æ˜¯ obj çš„åŸå‹é“¾ä¸Šçš„æŸä¸ªå¯¹è±¡
- æ³¨æ„ï¼šå³æ“ä½œæ•°å¿…é¡»æ˜¯å‡½æ•°æˆ–è€… class

```javascript
const arr = [1, 2, 3];
console.log(arr instanceof Array); // true
console.log(arr instanceof Object); // true

const obj = { name: "äº‘ç‰§", age: 18 };
console.log(obj instanceof Object); // true
console.log(obj instanceof Array); // false
```

## Object.prototype.toString.call()

Object.prototype.toString() æ˜¯ Object åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œå…¶é»˜è®¤è¡Œä¸ºæ˜¯è¿”å›ä¸€ä¸ªè¡¨ç¤ºå¯¹è±¡ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œæ ¼å¼ä¸º [object ç±»å‹å]ã€‚

åŸç†æ˜¯`xx.toString.call(value)`æ—¶ä¼šåœ¨ Value åŸºæœ¬æ•°æ®ç±»å‹æ—¶è¿›è¡ŒåŒ…è£…ï¼Œé¢„å¤„ç†æˆä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åæ‰“å°è¿™ä¸ªå¯¹è±¡ä¸Šçš„`[[Class]]`å±æ€§

- Object.prototype.toString.call(123) â†’ [object Number]
- Object.prototype.toString.call([]) â†’ [object Array]
- Object.prototype.toString.call(null) â†’ [object Null]

é™¤äº†è‡ªå®šä¹‰çš„å¯¹è±¡ï¼Œæ­¤æ–¹æ³•èƒ½åˆ¤æ–­ç»å¤§å¤šæ•°çš„å±æ€§ç±»å‹ã€‚

## åŒºåˆ«&æ€»ç»“

| æ–¹æ³•                               | æè¿°                                                             | ä¼˜ç‚¹                                          | ç¼ºç‚¹                                                                              | é€‚ç”¨åœºæ™¯                                                                                                      |
| :--------------------------------- | :--------------------------------------------------------------- | :-------------------------------------------- | :-------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------ |
| `typeof`                           | ä¸€å…ƒè¿ç®—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªè¡¨ç¤ºæ“ä½œæ•°ç±»å‹çš„å­—ç¬¦ä¸²ã€‚                     | ä½¿ç”¨ç®€å•ï¼Œæ‰§è¡Œé€Ÿåº¦å¿«ã€‚                        | æ— æ³•åŒºåˆ†`null`å’Œ`object`ï¼Œå¯¹äºå¼•ç”¨ç±»å‹é™¤äº†`function`éƒ½è¿”å›`object`ã€‚              | ä¸»è¦ç”¨äºåˆ¤æ–­**åŸºæœ¬æ•°æ®ç±»å‹**ï¼ˆ`string`, `number`, `boolean`, `undefined`, `symbol`, `bigint`ï¼‰å’Œ `function`ã€‚ |
| `constructor`                      | è®¿é—®å®ä¾‹å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚                                         | å¯ä»¥æ£€æµ‹å…·ä½“çš„å¼•ç”¨ç±»å‹ï¼Œå¦‚`Array`, `Object`ã€‚ | `constructor` å±æ€§å¯ä»¥è¢«è½»æ˜“ä¿®æ”¹ï¼Œå¯¼è‡´åˆ¤æ–­ä¸å¯é ã€‚å¯¹ `null` å’Œ `undefined` æ— æ•ˆã€‚ | åœ¨ç¡®å®šå¯¹è±¡çš„æ„é€ å‡½æ•°æœªè¢«ä¿®æ”¹æ—¶ï¼Œå¯ç”¨äºåˆ¤æ–­å…·ä½“çš„å¼•ç”¨ç±»å‹ã€‚                                                    |
| `instanceof`                       | è¿ç®—ç¬¦ï¼Œåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¦ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ã€‚                     | èƒ½åˆ¤æ–­å¯¹è±¡çš„å…·ä½“å¼•ç”¨ç±»å‹ï¼Œå¯ä»¥å¤„ç†ç»§æ‰¿å…³ç³»ã€‚  | æ— æ³•åˆ¤æ–­åŸºæœ¬æ•°æ®ç±»å‹ã€‚åœ¨è·¨ `iframe` æˆ– `window` çš„åœºæ™¯ä¸‹ä¼šå¤±æ•ˆã€‚                  | åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦åœ¨å¦ä¸€ä¸ªå¯¹è±¡çš„åŸå‹é“¾ä¸Šï¼Œé€‚åˆåˆ¤æ–­è‡ªå®šä¹‰ç±»å®ä¾‹å’Œå†…ç½®å¼•ç”¨ç±»å‹ã€‚                                  |
| `Object.prototype.toString.call()` | è°ƒç”¨ `Object` åŸå‹ä¸Šçš„ `toString` æ–¹æ³•ï¼Œè¿”å› `[object ç±»å‹å]`ã€‚ | æœ€å‡†ç¡®ã€æœ€é€šç”¨çš„æ–¹æ³•ã€‚                        | å†™æ³•ç›¸å¯¹ç¹çã€‚                                                                    | **æ¨èä½¿ç”¨**ã€‚é€‚ç”¨äºéœ€è¦ç²¾ç¡®åˆ¤æ–­æ‰€æœ‰æ•°æ®ç±»å‹çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦è·¨ `iframe` çš„æƒ…å†µä¸‹ã€‚                        |

## åˆ¤æ–­å˜é‡æ˜¯å¦æ˜¯ä¸ªæ•°ç»„

ä¸‹è¾¹ç®—æ˜¯ä¸ªå®æˆ˜ç¯èŠ‚ï¼Œä¹Ÿæ˜¯å¸¸è€ƒçš„å†…å®¹ ğŸ¥µ

### ä¸€. Array.isArray() æ–¹æ³•ï¼ˆæ¨èï¼‰

å¯ä»¥ä½¿ç”¨`Array.isArray`åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æ˜¯æ•°ç»„ï¼Œå‡†ç¡®ä¸”è¢«æ¨èã€‚

```JavaScript
const arr = [1, 2, 3];
console.log(Array.isArray(arr)); // true
```

### äºŒ. instanceof è¿ç®—ç¬¦

ä½¿ç”¨ instanceof æ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸º Array çš„**å®ä¾‹**ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ•°ç»„æ˜¯åœ¨ä¸åŒçš„å…¨å±€ä¸Šä¸‹æ–‡ï¼ˆæ¯”å¦‚ iframeï¼‰ä¸­åˆ›å»ºçš„ï¼Œè¿™ç§æ–¹æ³•ä¼šå¤±æ•ˆã€‚

```javascript
console.log(arr instanceof Array); // true
```

### ä¸‰. Object.prototype.toString.call

è¿™ç§æ–¹æ³•ä¼šè¿”å›å˜é‡çš„å…·ä½“ç±»å‹å­—ç¬¦ä¸²ï¼ˆå¦‚ "[object Array]"ï¼‰ï¼Œåœ¨åˆ¤æ–­æ•°ç»„æ—¶è¾ƒä¸ºé€šç”¨ï¼Œå³ä¾¿è·¨ç¯å¢ƒä¹Ÿèƒ½å‡†ç¡®åˆ¤æ–­ã€‚

```javascript
const arr = [1, 2, 3];
console.log(Object.prototype.toString.call(arr) === "[object Array]"); // true
```

### å››. æ„é€ å‡½æ•°åˆ¤æ–­

å¯ä»¥é€šè¿‡æ£€æŸ¥ constructor å±æ€§æ¥åˆ¤æ–­æ˜¯å¦æ˜¯æ•°ç»„ï¼Œä½†å¦‚æœæ•°ç»„çš„åŸå‹è¢«æ›´æ”¹è¿‡ï¼Œè¿™ç§æ–¹æ³•ä¼šå¤±è´¥ã€‚

```javascript
const arr = [1, 2, 3];
console.log(arr.constructor === Array); // true
```

## åˆ¤æ–­å˜é‡æ˜¯å¦æ˜¯ä¸€ä¸ªçº¯å¯¹è±¡

æœ€ä½³å®è·µ

```typescript
export function isPlainObject(
  value: unknown
): value is Record<string, unknown> {
  if (Object.prototype.toString.call(value) !== "[object Object]") return false;
  const proto = Object.getPrototypeOf(value);
  return proto === null || proto === Object.prototype;
}
```

> å¦‚æœéœ€è¦åˆ¤æ–­æ˜¯å¦æ˜¯ç©ºå¯¹è±¡ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šä½¿ç”¨ Object.keys()è·å¾—é”®çš„æ•°ç»„ï¼Œç„¶ååˆ¤æ–­æ•°ç»„é•¿åº¦å³å¯
