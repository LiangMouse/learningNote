# Fiber 架构

#### 背景

在 `React v15` 以及之前版本中，React 应用是通过递归遍历组件树实现的。当组件状态发生变化时，React 会重新计算并渲染整个组件树，然后将变化的部分更新到 DOM 上。这种算法虽然简单易懂，但是也存在一些缺点：

当组件树非常庞大时，递归遍历整个组件树的开销很大，导致应用性能下降。
如果某个组件在更新过程中发生了阻塞，那么整个组件树的更新也会被阻塞，用户体验不佳。
为了解决这些问题，React 团队在 v16 中引入了一种新的**协调算法**——`React Fiber`。

### 设计原理

- React Fiber 的核心思想是将组件树的遍历变成了可中断的异步任务。具体来说，React Fiber 会将整个组件树拆分成多个小的任务单元（Fiber），并按照优先级顺序依次执行这些任务单元。每当执行完一个任务单元时，React Fiber 就会检查当前是否有更高优先级的任务需要执行。如果有，则立即暂停当前任务，并开始执行更高优先级的任务，直到完成后再回来继续执行原来的任务。这样一来，React Fiber 可以让应用更加灵活地响应用户交互和其他事件。
