# RAG

**检索增强生成** Retrieval-augmented generation

可以简单的理解为存储了一堆信息（公司的规章制度、解决问题的 QA 问答对、特定领域的知识等）的数据库。这些信息可以是结构化的知识图谱，也可以是非结构化的文本。
存储方式上，一般采用 ES、向量数据库、图数据库等存储方式；搜索手段上，采用混合搜索：语义搜索+关键词搜索
在和 LLM 结合时，我们通常采用 **RAG**（检索增强生成）。

## 处理过程

分为知识库输入文件过程和用户提问的文本匹配过程

### 文件输入过程

1. 用户把大文件添加进知识库
2. 程序将大文件拆分成很多个文本块
3. 使用嵌入模型分别对文本块进行向量化(文本转成数字序列)
4. 程序将向量以及对应文本存入向量数据库

### 用户提问

1. 用户提问内容通过嵌入模型向量化
2. 将生成向量与向量数据库进行相似度匹配(向量余弦数学计算)
3. 数据库返回匹配度 TopK 的原文片段

4. 将用户提问问题和原文片段返回大模型
5. 大模型进行归纳总结并返回用户

## 应用场景

## 优缺点

### 缺点

- 切片简单粗暴

  - 主流的文块分割算法是按照文本段进行不同文本块的分割，但受制上下文长度，最多能容纳 300 个字，这就会导致段落在中间截断，文本块信息紊乱.AI 难以理解上下文关系，降低输出的精准性

- 检索不精准
  - RAG 基于向量的数学计算进行匹配无法在语义上精确匹配
  - 当前解决方法有重排序模型， 按问题相关性对 TopK 返回内容进行更深入语义分析重新排序(模型类型选择重排序)
- 没有大局观
  - 统计性的问题(一共有多少个/最大？) 不能解决。 因为他在原理上只能返回几个文本块
  - 应当使用关系型数据库将进行解决，AI 场景下可以用 MCP server 操纵关系型数据库
